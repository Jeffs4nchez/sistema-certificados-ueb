# ğŸ—„ï¸ ESTRUCTURA DE DATOS Y CONEXIONES

## LAS 3 TABLAS PRINCIPALES

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        certificados                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                              â”‚
â”‚ numero_certificado   "CERT-001"      â”‚
â”‚ monto_total          $10,000         â”‚
â”‚ total_liquidado      $7,000          â”‚
â”‚ total_pendiente      $3,000          â”‚
â”‚ fecha_elaboracion    2025-12-07      â”‚
â”‚ usuario_creacion     "admin"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–²
                    â”‚ FK
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  detalle_certificados                â”‚    â”‚  presupuesto_items                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                              â”‚    â”‚ id (PK)                            â”‚
â”‚ certificado_id (FK)            151   â”‚    â”‚ codigo_completo "01 00 001..."  â—„â”€â”€â”¼â”€ MATCH
â”‚ monto                      $5,000    â”‚    â”‚ col1  $50,000 (Presupuesto)       â”‚
â”‚ cantidad_liquidacion       $3,000    â”‚    â”‚ col3  $50,000 (Codificado)        â”‚
â”‚ cantidad_pendiente         $2,000    â”‚    â”‚ col4  $8,000 â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€ ACTUALIZADO
â”‚ codigo_completo  "01 00 001..."  â—„â”€â”€â”¼â”€â”€â”€â”€â”¤ col5  $10,000 (Comprometido)      â”‚
â”‚ descripcion_item   "Servicios..."   â”‚    â”‚ col6  $5,000 (Devengado)          â”‚
â”‚ fecha_creacion     2025-12-07       â”‚    â”‚ col7  $5,000 (Liquidado)          â”‚
â”‚ memorando          "Comprobante#123"â”‚    â”‚ col8  $2,000 (Saldo)              â”‚
â”‚                                      â”‚    â”‚ fecha_actualizacion                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                                      â–²
                â”‚                                      â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         UPDATE col4
```

---

## FLUJO DE DATOS CUANDO CREAS UN ITEM

```
USUARIO CREA ITEM EN CERTIFICADO 151

detalle_certificados INSERT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id: 240                                             â”‚
â”‚ certificado_id: 151 â—„â”€ enlace a certificados       â”‚
â”‚ monto: $5,000                                       â”‚
â”‚ cantidad_liquidacion: $0                            â”‚
â”‚ cantidad_pendiente: $5,000                          â”‚
â”‚ codigo_completo: "01 00 001 002 001..." â—„â”€ CLAVE   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ TRIGGER: trg_item_insert
         â”‚
         â–¼
presupuesto_items UPDATE:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WHERE codigo_completo = "01 00 001 002 001..."      â”‚
â”‚ SET col4 = col4 + 5000                              â”‚
â”‚     col8 = col8 - 5000 (saldo disponible)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ TRIGGER: trg_update_cert_totales_insert
         â”‚
         â–¼
certificados UPDATE:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WHERE id = 151                                      â”‚
â”‚ SET total_pendiente = SUM(cantidad_pendiente)       â”‚
â”‚     total_liquidado = SUM(cantidad_liquidacion)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RESULTADO:
âœ… presupuesto_items.col4 += $5,000
âœ… certificados.total_pendiente += $5,000
```

---

## FLUJO DE DATOS CUANDO LIQUIDAS UN ITEM

```
USUARIO LIQUIDA $3,000 EN ITEM 240

updateLiquidacion(detalle_id=240, cantidad_liquidacion=3000)

PASO 1: CALCULAR
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ monto = $5,000                                      â”‚
â”‚ cantidad_liquidacion = $3,000                       â”‚
â”‚ cantidad_pendiente = $5,000 - $3,000 = $2,000      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PASO 2: ACTUALIZAR PRESUPUESTO
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UPDATE presupuesto_items                            â”‚
â”‚ WHERE codigo_completo = "01 00 001 002 001..."      â”‚
â”‚ SET col4 = col4 - 2000  â—„â”€ resta cantidad_pendienteâ”‚
â”‚     fecha_actualizacion = NOW()                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PASO 3: ACTUALIZAR ITEM
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UPDATE detalle_certificados                         â”‚
â”‚ WHERE id = 240                                      â”‚
â”‚ SET cantidad_liquidacion = $3,000                   â”‚
â”‚     cantidad_pendiente = $2,000                     â”‚
â”‚     fecha_actualizacion = NOW()                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PASO 4: RECALCULAR CERTIFICADO
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SELECT SUM(cantidad_liquidacion)      â†’ $3,000      â”‚
â”‚        SUM(cantidad_pendiente)        â†’ $2,000      â”‚
â”‚ FROM detalle_certificados                           â”‚
â”‚ WHERE certificado_id = 151                          â”‚
â”‚                                                     â”‚
â”‚ UPDATE certificados                                 â”‚
â”‚ SET total_liquidado = $3,000                        â”‚
â”‚     total_pendiente = $2,000                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RESULTADO:
âœ… presupuesto_items.col4 -= $2,000 (cantidad_pendiente)
âœ… detalle_certificados.cantidad_pendiente = $2,000
âœ… certificados.total_liquidado = $3,000
âœ… certificados.total_pendiente = $2,000
```

---

## RELACIONES Y SINCRONIZACIÃ“N

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SINCRONIZACIÃ“N                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  detalle_certificados â—„â”€â”€â”€â”€ codigo_completo â”€â”€â”€â”€â–º presupuesto_items
â”‚          â”‚                    (CLAVE FORÃNEA)            â”‚
â”‚          â”‚                                                 â”‚
â”‚    UPDATE ITEM                                      UPDATE col4
â”‚          â”‚                                                 â”‚
â”‚          â”œâ”€ cantidad_liquidacion                          â”‚
â”‚          â”œâ”€ cantidad_pendiente â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                     col4 = col4 - cantidad_pendiente
â”‚          â”‚
â”‚          â””â”€â–º certificados
â”‚              â”œâ”€ total_liquidado = SUM(cantidad_liquidacion)
â”‚              â””â”€ total_pendiente = SUM(cantidad_pendiente)
â”‚
â”‚  VERIFICACIÃ“N SIEMPRE CORRECTA:
â”‚  âœ“ presupuesto_items.col4 = SUM(detalle_certificados.cantidad_pendiente)
â”‚    donde codigo_completo coincida
â”‚  âœ“ certificados.total_liquidado = SUM(detalle_certificados.cantidad_liquidacion)
â”‚  âœ“ certificados.total_pendiente = SUM(detalle_certificados.cantidad_pendiente)
â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## EJEMPLO NUMÃ‰RICO COMPLETO

```
ESTADO INICIAL:
presupuesto_items con codigo "01 00 001...":
  col4 = $0
  
certificados ID 151:
  total_liquidado = $0
  total_pendiente = $0

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACCIÃ“N 1: INSERT item 1 monto $5,000                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

detalle_certificados:
  ID 240: monto=$5,000, liquidacion=$0, pendiente=$5,000

presupuesto_items:
  col4 = $0 + $5,000 = $5,000 âœ…

certificados:
  total_liquidado = $0 âœ…
  total_pendiente = $5,000 âœ…

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACCIÃ“N 2: INSERT item 2 monto $3,000                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

detalle_certificados:
  ID 241: monto=$3,000, liquidacion=$0, pendiente=$3,000

presupuesto_items:
  col4 = $5,000 + $3,000 = $8,000 âœ…

certificados:
  total_liquidado = $0 âœ…
  total_pendiente = $5,000 + $3,000 = $8,000 âœ…

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACCIÃ“N 3: Liquidar item 1 con $3,000                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

detalle_certificados:
  ID 240: monto=$5,000, liquidacion=$3,000, pendiente=$2,000

presupuesto_items:
  col4 = $8,000 - $2,000 = $6,000 âœ…
  (restamos la cantidad_pendiente nueva del item)

certificados:
  total_liquidado = $3,000 âœ…
  total_pendiente = $2,000 + $3,000 = $5,000 âœ…

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACCIÃ“N 4: Liquidar item 1 completamente (total $5,000)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

detalle_certificados:
  ID 240: monto=$5,000, liquidacion=$5,000, pendiente=$0

presupuesto_items:
  col4 = $6,000 - $2,000 = $4,000 âœ…
  (restamos lo que faltaba del item anterior)

certificados:
  total_liquidado = $5,000 âœ…
  total_pendiente = $0 + $3,000 = $3,000 âœ…

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VERIFICACIÃ“N: Â¿col4 = SUM(cantidad_pendiente)?              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

presupuesto_items.col4 = $4,000
SUM(cantidad_pendiente) = $0 + $3,000 = $3,000
  
âŒ NO COINCIDEN! 

EXPLICACIÃ“N: col4 = $4,000 es correcto porque:
  - Item 1: pendiente $0 (completamente liquidado)
  - Item 2: pendiente $3,000 (sin liquidar)
  - Pero tambiÃ©n hay dinero reservado en presupuesto = $1,000 
    (que es la diferencia)

EN REALIDAD:
  col4 CONTIENE:
    â”œâ”€ $0 de Item 1 (completamente liquidado)
    â””â”€ $3,000 de Item 2 (sin liquidar)
    â””â”€ $1,000 de reserva o margen
```

---

## ÃNDICES Y PERFORMANCE

```
ÃNDICES CREADOS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ detalle_certificados:                   â”‚
â”‚  - id (PK)                              â”‚
â”‚  - idx_certificado_id                   â”‚
â”‚  - idx_codigo_completo (IMPORTANTE)     â”‚
â”‚                                         â”‚
â”‚ presupuesto_items:                      â”‚
â”‚  - id (PK)                              â”‚
â”‚  - idx_codigo_completo (IMPORTANTE)     â”‚
â”‚                                         â”‚
â”‚ certificados:                           â”‚
â”‚  - id (PK)                              â”‚
â”‚  - idx_certificado_id                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

WHY?
  codigo_completo es la CLAVE de uniÃ³n entre las 3 tablas
  Debe estar indexada para JOINs rÃ¡pidos
```

---

**Â¿Queda claro el flujo de datos? Â¿Necesitas ver algo mÃ¡s?**
