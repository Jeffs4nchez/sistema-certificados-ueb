================================================================================
SISTEMA DE RECUPERACI√ìN DE CONTRASE√ëA - OPCI√ìN 3 (ADMIN)
================================================================================

DESCRIPCI√ìN:
Sistema de recuperaci√≥n de contrase√±a gestionado por administradores.
Permite a los admins resetear la contrase√±a de cualquier usuario y generar
una contrase√±a temporal que se comparte de manera segura.

================================================================================
C√ìMO FUNCIONA:
================================================================================

1. ADMIN ACCEDE AL PANEL DE USUARIOS
   - Ir a: ?action=usuario&method=listar
   - O desde el men√∫: Sistema ‚Üí Usuarios

2. BUSCAR AL USUARIO CUYA CONTRASE√ëA SE DESEA RESETEAR
   - Usar el filtro de b√∫squeda por nombre o correo
   - El usuario debe estar ACTIVO en el sistema

3. HACER CLIC EN BOT√ìN "RESETEAR CONTRASE√ëA"
   - Bot√≥n rojo con icono de llave (üîë)
   - Se abre un modal de confirmaci√≥n

4. CONFIRMAR LA ACCI√ìN
   - El modal muestra los datos del usuario
   - Advertencia: Se generar√° contrase√±a temporal
   - Hacer clic en "Resetear Contrase√±a"

5. COMPARTIR CONTRASE√ëA TEMPORAL CON EL USUARIO
   - Sistema genera contrase√±a de 8 caracteres aleatorios
   - Ejemplo: aB3$#xYz
   - IMPORTANTE: Compartir de manera segura (NO por email sin cifrar)
   - Opciones seguras:
     * En persona
     * Por tel√©fono
     * Por WhatsApp/Telegram (verificar identidad)
     * Por Sistema seguro de tickets

6. USUARIO INICIA SESI√ìN CON CONTRASE√ëA TEMPORAL
   - Usa la contrase√±a temporal para acceder
   - Recomendaci√≥n: Cambiar contrase√±a en el perfil ASAP

================================================================================
CARACTER√çSTICAS:
================================================================================

‚úì Contrase√±a temporal aleatoria de 8 caracteres
‚úì Incluye may√∫sculas, min√∫sculas, n√∫meros y s√≠mbolos
‚úì Se muestra en la pantalla despu√©s del reseteo
‚úì Sin necesidad de enviar emails
‚úì Control total del administrador
‚úì Registro de qui√©n cambi√≥ la contrase√±a (en logs si est√° habilitado)

================================================================================
ARCHIVOS MODIFICADOS:
================================================================================

1. app/controllers/UsuarioController.php
   - Agregado m√©todo: resetearContrase√±a()
   - Agregado m√©todo privado: generarContrase√±aTemporal()

2. app/views/usuarios/list.php
   - Agregado bot√≥n "Resetear Contrase√±a" en tabla de usuarios
   - Agregados modales de confirmaci√≥n por usuario
   - Script para mejorar visualizaci√≥n de mensajes de √©xito

3. app/models/Usuario.php
   - M√©todo cambiarContrase√±a() ya exist√≠a (sin cambios)

================================================================================
FLUJO T√âCNICO:
================================================================================

1. Usuario hace clic en bot√≥n "Resetear Contrase√±a"
   ‚îî‚îÄ> Se abre modal (Bootstrap)

2. Admin confirma en el modal
   ‚îî‚îÄ> Env√≠a POST a: ?action=usuario&method=resetearContrase√±a

3. UsuarioController::resetearContrase√±a() ejecuta:
   - Valida permisos del admin
   - Obtiene datos del usuario
   - Genera contrase√±a temporal de 8 caracteres
   - Llama a Usuario::cambiarContrase√±a()

4. Usuario::cambiarContrase√±a():
   - Encripta contrase√±a con PASSWORD_BCRYPT
   - Actualiza en BD tabla 'usuarios'
   - Registra timestamp de actualizaci√≥n

5. Resultado:
   - Muestra alerta con contrase√±a temporal
   - Redirige a lista de usuarios

================================================================================
SEGURIDAD:
================================================================================

‚úì Solo administradores pueden resetear contrase√±as
‚úì Validaci√≥n de permisos en el controlador
‚úì Contrase√±as encriptadas con PASSWORD_BCRYPT
‚úì Verificaci√≥n de existencia del usuario
‚úì Sin almacenamiento de contrase√±a en texto plano
‚úì Contrase√±a temporal √∫nica cada vez

RECOMENDACIONES:
- Informar al usuario INMEDIATAMENTE despu√©s del reseteo
- Usar canal seguro para compartir la contrase√±a temporal
- Aconsejar al usuario que cambie la contrase√±a en su perfil
- Registrar en notas el motivo del reseteo (si es necesario)

================================================================================
CAMBIOS EN LA BD:
================================================================================

NO se requieren cambios en la estructura de la BD.
La tabla 'usuarios' ya existe con las columnas necesarias:
- id (int)
- contrase√±a (varchar - almacenada en hash)
- fecha_actualizacion (timestamp)

================================================================================
EJEMPLO DE USO:
================================================================================

USUARIO: Juan P√©rez (juan.perez@ejemplo.com)
PROBLEMA: Olvid√≥ su contrase√±a

1. Admin va a: ?action=usuario&method=listar
2. Busca "juan" en el filtro
3. Hace clic en bot√≥n rojo üîë "Resetear Contrase√±a"
4. Lee advertencia en el modal
5. Hace clic en "Resetear Contrase√±a"
6. Sistema muestra: "Contrase√±a reseteada exitosamente. Nueva contrase√±a temporal: Kj8@pL2x"
7. Admin comparte "Kj8@pL2x" con Juan por medio seguro
8. Juan inicia sesi√≥n con esa contrase√±a
9. Juan va a su perfil y cambia la contrase√±a a una que solo √©l conoce

================================================================================
SOLUCI√ìN DE PROBLEMAS:
================================================================================

PROBLEMA: "Error al resetear la contrase√±a"
SOLUCI√ìN:
- Verificar que la BD est√© conectada
- Verificar permisos en la tabla usuarios
- Revisar logs de error de PHP

PROBLEMA: Usuario no puede iniciar sesi√≥n con la nueva contrase√±a
SOLUCI√ìN:
- Verificar que la nueva contrase√±a se guard√≥ (revisar BD)
- Limpiar cookies/cache del navegador
- Intentar resetear nuevamente
- Verificar que el usuario est√© ACTIVO en el sistema

PROBLEMA: No aparece el bot√≥n "Resetear Contrase√±a"
SOLUCI√ìN:
- Verificar que eres administrador
- Actualizar la p√°gina (F5)
- Verificar que el usuario est√° en estado ACTIVO

================================================================================
PR√ìXIMOS PASOS / MEJORAS FUTURAS:
================================================================================

Opcional - Se puede mejorar con:
1. Env√≠o autom√°tico de email con contrase√±a temporal (requiere SMTP)
2. Link de reseteo de contrase√±a por email
3. Historial de cambios de contrase√±a (auditor√≠a)
4. Expiraci√≥n de contrase√±a despu√©s de X d√≠as
5. Notificaci√≥n a usuario cuando admin resetea su contrase√±a
6. Requerimiento de cambio de contrase√±a al primer login

================================================================================
PREGUNTAS FRECUENTES:
================================================================================

P: ¬øSe env√≠a la contrase√±a por email autom√°ticamente?
R: No. Debes compartirla manualmente de manera segura.

P: ¬øSe registra qui√©n resetea la contrase√±a?
R: Actualmente no (opcional agregarlo con auditor√≠a).

P: ¬øCu√°nto tiempo es v√°lida la contrase√±a temporal?
R: Indefinidamente, hasta que el usuario la cambie.

P: ¬øQu√© pasa si olvido copiar la contrase√±a?
R: Puedes resetear de nuevo para generar una nueva.

P: ¬øLos usuarios pueden resetear su propia contrase√±a?
R: Actualmente no. Solo administradores pueden resetear.

================================================================================
SOPORTE:
================================================================================

Para reportar problemas o sugerencias, contactar al equipo de desarrollo.

================================================================================
